{"version":3,"sources":["webpack:///./src/app/pages/tabs/messages/chat-room/chat-room-page.component.html","webpack:///./src/app/pages/tabs/messages/chat-room/chat-room-page.component.scss","webpack:///./src/app/pages/tabs/messages/chat-room/chat-room-page.component.ts","webpack:///./src/app/pages/tabs/messages/chat-room/chat-room.module.ts"],"names":[],"mappings":"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","file":"pages-tabs-messages-chat-room-chat-room-module.js","sourcesContent":["module.exports = \"<ion-header>\\n  <ion-toolbar>\\n      <ion-title (click)=\\\"goToRidePlanPage()\\\">{{chatRoom.ride.originName}}\\n           -\\n          {{chatRoom.ride.destinationName}}</ion-title>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content padding>\\n  <div *ngIf=\\\"chatRoom\\\">\\n    <div class=\\\"message-area\\\">\\n      <div class=\\\"message\\\" *ngFor=\\\"let message of messages\\\" [ngClass]=\\\"getClasses(message)\\\">\\n        <ion-avatar *ngIf=\\\"message.fromUser != currentUser.id\\\"><img src=\\\"{{ otherUser?.photo }}\\\"></ion-avatar>\\n        <p>{{message.content}}</p>\\n        <span>{{message.date}}</span>\\n      </div>\\n    </div>\\n  </div>\\n\\n\\n</ion-content>\\n\\n<ion-footer>\\n  <ion-toolbar>\\n    <ion-textarea [(ngModel)]=\\\"msg\\\" class=\\\"message-input\\\" placeholder=\\\"Type a message here\\\" rows=\\\"1\\\" autocapitalize=\\\"off\\\"\\n                  #messageInput\\n                  (keydown.enter)=\\\"sendMessage();false\\\"></ion-textarea>\\n    <ion-buttons slot=\\\"end\\\">\\n      <ion-button color=\\\"primary\\\" (click)=\\\"sendMessage()\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"md-send\\\"></ion-icon>\\n      </ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-footer>\\n\"","module.exports = \":host .message-area {\\n  max-height: 90%;\\n  height: 90%;\\n  overflow: auto;\\n  padding: 15px 10px; }\\n  :host .message-area .message p {\\n    color: #8a898b;\\n    font-size: 13px;\\n    font-weight: bold;\\n    margin: 0px;\\n    max-width: 95%;\\n    min-width: 55%;\\n    box-shadow: 0 1px 1px 0 rgba(0, 0, 0, 0.1);\\n    padding: 10px 15px 10px 7px;\\n    margin: 5px 0;\\n    background: #B9C0E9; }\\n  :host .message-area .message.incoming {\\n    display: -webkit-flex;\\n    display: flex;\\n    -webkit-flex-direction: row;\\n            flex-direction: row;\\n    -webkit-justify-content: flex-start;\\n            justify-content: flex-start;\\n    -webkit-align-items: flex-start;\\n            align-items: flex-start; }\\n  :host .message-area .message.incoming p {\\n      border-radius: 0 11px 11px 11px;\\n      background: white; }\\n  :host .message-area .message.incoming ion-avatar {\\n      margin-right: 5px; }\\n  :host .message-area .message.incoming ion-avatar img {\\n        width: 40px;\\n        height: 40px; }\\n  :host .message-area .message.outgoing {\\n    display: -webkit-flex;\\n    display: flex;\\n    -webkit-flex-direction: column;\\n            flex-direction: column;\\n    -webkit-justify-content: flex-end;\\n            justify-content: flex-end;\\n    -webkit-align-items: flex-end;\\n            align-items: flex-end; }\\n  :host .message-area .message.outgoing p {\\n      color: white;\\n      border-radius: 11px 11px 0 11px; }\\n  :host ion-footer {\\n  --ion-toolbar-background-color: var(--ion-color-white); }\\n  :host ion-footer .message-input {\\n    padding-left: 8px; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tb25leWJhL0RvY3VtZW50cy90Zm0vc3JjL2FwcC9wYWdlcy90YWJzL21lc3NhZ2VzL2NoYXQtcm9vbS9jaGF0LXJvb20tcGFnZS5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUdJLGVBQWU7RUFDZixXQUFXO0VBQ1gsY0FBYztFQUNkLGtCQUFrQixFQUFBO0VBTnRCO0lBV1EsY0FBYztJQUNkLGVBQWU7SUFDZixpQkFBaUI7SUFDakIsV0FBVztJQUNYLGNBQWM7SUFDZCxjQUFjO0lBQ2QsMENBQTBDO0lBQzFDLDJCQUEyQjtJQUMzQixhQUFhO0lBQ2IsbUJBQW1CLEVBQUE7RUFwQjNCO0lBMEJNLHFCQUFhO0lBQWIsYUFBYTtJQUNiLDJCQUFtQjtZQUFuQixtQkFBbUI7SUFDbkIsbUNBQTJCO1lBQTNCLDJCQUEyQjtJQUMzQiwrQkFBdUI7WUFBdkIsdUJBQXVCLEVBQUE7RUE3QjdCO01BZ0NRLCtCQUErQjtNQUMvQixpQkFBaUIsRUFBQTtFQWpDekI7TUFxQ1EsaUJBQWlCLEVBQUE7RUFyQ3pCO1FBd0NVLFdBQVc7UUFDWCxZQUFZLEVBQUE7RUF6Q3RCO0lBK0NNLHFCQUFhO0lBQWIsYUFBYTtJQUNiLDhCQUFzQjtZQUF0QixzQkFBc0I7SUFDdEIsaUNBQXlCO1lBQXpCLHlCQUF5QjtJQUN6Qiw2QkFBcUI7WUFBckIscUJBQXFCLEVBQUE7RUFsRDNCO01BcURRLFlBQVk7TUFDWiwrQkFBK0IsRUFBQTtFQXREdkM7RUE2REksc0RBQStCLEVBQUE7RUE3RG5DO0lBZ0VNLGlCQUFpQixFQUFBIiwiZmlsZSI6InNyYy9hcHAvcGFnZXMvdGFicy9tZXNzYWdlcy9jaGF0LXJvb20vY2hhdC1yb29tLXBhZ2UuY29tcG9uZW50LnNjc3MiLCJzb3VyY2VzQ29udGVudCI6WyI6aG9zdCB7XG5cbiAgLm1lc3NhZ2UtYXJlYSB7XG4gICAgbWF4LWhlaWdodDogOTAlO1xuICAgIGhlaWdodDogOTAlO1xuICAgIG92ZXJmbG93OiBhdXRvO1xuICAgIHBhZGRpbmc6IDE1cHggMTBweDtcblxuICAgIC5tZXNzYWdlIHtcblxuICAgICAgcCB7XG4gICAgICAgIGNvbG9yOiAjOGE4OThiO1xuICAgICAgICBmb250LXNpemU6IDEzcHg7XG4gICAgICAgIGZvbnQtd2VpZ2h0OiBib2xkO1xuICAgICAgICBtYXJnaW46IDBweDtcbiAgICAgICAgbWF4LXdpZHRoOiA5NSU7XG4gICAgICAgIG1pbi13aWR0aDogNTUlO1xuICAgICAgICBib3gtc2hhZG93OiAwIDFweCAxcHggMCByZ2JhKDAsIDAsIDAsIDAuMSk7XG4gICAgICAgIHBhZGRpbmc6IDEwcHggMTVweCAxMHB4IDdweDtcbiAgICAgICAgbWFyZ2luOiA1cHggMDtcbiAgICAgICAgYmFja2dyb3VuZDogI0I5QzBFOTtcbiAgICAgIH1cblxuICAgIH1cblxuICAgIC5tZXNzYWdlLmluY29taW5nIHtcbiAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICBmbGV4LWRpcmVjdGlvbjogcm93O1xuICAgICAganVzdGlmeS1jb250ZW50OiBmbGV4LXN0YXJ0O1xuICAgICAgYWxpZ24taXRlbXM6IGZsZXgtc3RhcnQ7XG5cbiAgICAgIHAge1xuICAgICAgICBib3JkZXItcmFkaXVzOiAwIDExcHggMTFweCAxMXB4O1xuICAgICAgICBiYWNrZ3JvdW5kOiB3aGl0ZTtcbiAgICAgIH1cblxuICAgICAgaW9uLWF2YXRhciB7XG4gICAgICAgIG1hcmdpbi1yaWdodDogNXB4O1xuXG4gICAgICAgIGltZyB7XG4gICAgICAgICAgd2lkdGg6IDQwcHg7XG4gICAgICAgICAgaGVpZ2h0OiA0MHB4O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLm1lc3NhZ2Uub3V0Z29pbmcge1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gICAgICBqdXN0aWZ5LWNvbnRlbnQ6IGZsZXgtZW5kO1xuICAgICAgYWxpZ24taXRlbXM6IGZsZXgtZW5kO1xuXG4gICAgICBwIHtcbiAgICAgICAgY29sb3I6IHdoaXRlO1xuICAgICAgICBib3JkZXItcmFkaXVzOiAxMXB4IDExcHggMCAxMXB4O1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG5cbiAgaW9uLWZvb3RlciB7XG4gICAgLS1pb24tdG9vbGJhci1iYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1pb24tY29sb3Itd2hpdGUpO1xuXG4gICAgLm1lc3NhZ2UtaW5wdXQge1xuICAgICAgcGFkZGluZy1sZWZ0OiA4cHg7XG4gICAgfVxuICB9XG5cbn1cbiJdfQ== */\"","import {Component, OnInit} from '@angular/core';\nimport {ActivatedRoute, NavigationExtras, Router} from '@angular/router';\nimport {User} from '../../../../shared/models/User';\nimport {Chat} from '../../../../shared/models/Chat';\nimport {ChatRoomService} from '../../../../core/services/chat-room.service';\nimport {Message} from '../../../../shared/models/Message';\nimport {UserService} from '../../../../core/services/user.service';\nimport {State} from '../../../../shared/ui.utils';\n\n@Component({\n    selector: 'app-chat-room',\n    templateUrl: './chat-room-page.component.html',\n    styleUrls: ['./chat-room-page.component.scss'],\n})\nexport class ChatRoomPage implements OnInit {\n    public chatRoom: Chat;\n    public currentUser: User;\n    public otherUser: User;\n\n    public messages: Message[] = [];\n    public msg: string;\n\n    constructor(private route: ActivatedRoute,\n                private router: Router,\n                private chatRoomService: ChatRoomService,\n                private chatService: ChatRoomService,\n                private userService: UserService\n    ) {\n        this.currentUser = this.userService.user.getValue();\n\n\n        this.route.queryParams.subscribe(params => {\n            if (this.router.getCurrentNavigation().extras.state) {\n                this.chatRoom = this.router.getCurrentNavigation().extras.state.chatRoom;\n                this.chatRoom.messages = [];\n                this.getChatRoom();\n                this.getOtherUser();\n            }\n        });\n\n    }\n\n    ngOnInit() {\n    }\n\n    public getChatRoom(): void {\n        this.chatRoomService.getChatRoom(this.chatRoom.id).subscribe((chatRoom: Chat) => {\n            this.messages = this.getArrayFromObject(chatRoom.messages);\n        });\n    }\n\n    public getArrayFromObject(object): any[] {\n        return Object.keys(object || {}).map(key => object[key]);\n    }\n\n    public sendMessage(): void {\n\n        const message: Message = {\n            content: this.msg,\n            date: new Date(),\n            fromUser: this.currentUser.id,\n            toUser: this.getReceiver()\n        };\n\n        this.chatService.sendMessage(message, this.chatRoom.id).then(() => this.getChatRoom());\n        this.msg = '';\n    }\n\n    private getReceiver(): string {\n        return this.currentUser.id === this.chatRoom.passengerUser ? this.chatRoom.driverUser : this.chatRoom.passengerUser;\n    }\n\n    public goToRidePlanPage():void {\n        const navigationExtras: NavigationExtras = {\n            state: {\n                ride: this.chatRoom.ride\n            }\n        };\n        this.router.navigate(['ride-plan'], navigationExtras);\n    }\n\n    public getOtherUser(): void {\n        if (this.chatRoom.passengerUser === this.currentUser.id) {\n            this.userService.getUser(this.chatRoom.driverUser).subscribe(user => this.otherUser = user);\n        } else {\n            this.userService.getUser(this.chatRoom.passengerUser).subscribe(user => this.otherUser = user);\n        }\n    }\n\n    public gotoUserProfile(userId: string): void {\n        const navigationExtras: NavigationExtras = {\n            state: {\n                userId\n            }\n        };\n        this.router.navigate(['public-profile'], navigationExtras);\n    }\n\n    public getClasses(message): any {\n        return {\n            incoming:  message.fromUser != this.currentUser.id,\n            outgoing: message.fromUser === this.currentUser.id,\n        };\n    }\n\n\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ChatRoomPage } from './chat-room-page.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ChatRoomPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [ChatRoomPage]\n})\nexport class ChatRoomPageModule {}\n"],"sourceRoot":""}