{"version":3,"sources":["webpack:///./src/app/core/services/ride.service.ts","webpack:///./src/app/pages/tabs/messages/chat/chat-page.component.html","webpack:///./src/app/pages/tabs/messages/chat/chat-page.component.scss","webpack:///./src/app/pages/tabs/messages/chat/chat-page.component.ts","webpack:///./src/app/pages/tabs/messages/chat/chat.module.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;AAAyC;AAEkB;AAQ3D;IAGI,qBAAoB,EAAuB;QAAvB,OAAE,GAAF,EAAE,CAAqB;QAFnC,uBAAkB,GAAG,OAAO,CAAC;IAGrC,CAAC;IAEM,gCAAU,GAAjB,UAAkB,IAAU;QACxB,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,EAAE,CAAC,YAAY,EAAE,CAAC;QACjC,OAAO,IAAI,CAAC,EAAE,CAAC,MAAM,CAAU,IAAI,CAAC,kBAAkB,SAAI,IAAI,CAAC,EAAI,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;IACnF,CAAC;IAEM,gCAAU,GAAjB,UAAkB,IAAU;QACxB,OAAO,IAAI,CAAC,EAAE,CAAC,MAAM,CAAU,IAAI,CAAC,kBAAkB,SAAI,IAAI,CAAC,EAAI,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IACtF,CAAC;IAEM,gCAAU,GAAjB,UAAkB,MAAc;QAC5B,OAAO,IAAI,CAAC,EAAE,CAAC,MAAM,CAAU,IAAI,CAAC,kBAAkB,SAAI,MAAQ,CAAC,CAAC,MAAM,EAAE,CAAC;IACjF,CAAC;IAEM,8BAAQ,GAAf;QACI,OAAO,IAAI,CAAC,EAAE,CAAC,IAAI,CAAO,IAAI,CAAC,kBAAkB,EAAE,aAAG,IAAI,UAAG,CAAC,YAAY,CAAC,UAAU,CAAC;aACjF,OAAO,CAAC,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC,EADwB,CACxB,CAAC,CAAC,YAAY,EAAE,CAAC;IACvD,CAAC;IAEM,sCAAgB,GAAvB,UAAwB,MAAc;QAClC,OAAO,IAAI,CAAC,EAAE,CAAC,IAAI,CAAO,IAAI,CAAC,kBAAkB,EAAE,aAAG,IAAI,UAAG,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,EAA1C,CAA0C,CAAC,CAAC,YAAY,EAAE,CAAC;IACzH,CAAC;IAEM,6BAAO,GAAd,UAAe,MAAc;QACzB,OAAO,IAAI,CAAC,EAAE,CAAC,MAAM,CAAU,IAAI,CAAC,kBAAkB,SAAI,MAAQ,CAAC,CAAC,YAAY,EAAE,CAAC;IACvF,CAAC;IA9BQ,WAAW;QAHvB,gEAAU,CAAC;YACR,UAAU,EAAE,MAAM;SACrB,CAAC;+EAI0B,0EAAmB;OAHlC,WAAW,CA+BvB;IAAD,kBAAC;CAAA;AA/BuB;;;;;;;;;;;;ACVxB,mGAAmG,kBAAkB,4BAA4B,uBAAuB,qcAAqc,kBAAkB,+BAA+B,iBAAiB,sBAAsB,cAAc,0TAA0T,uQ;;;;;;;;;;;ACA7gC,uCAAuC,oBAAoB,gBAAgB,mBAAmB,uBAAuB,EAAE,oCAAoC,qBAAqB,sBAAsB,wBAAwB,kBAAkB,qBAAqB,qBAAqB,iDAAiD,kCAAkC,oBAAoB,0BAA0B,EAAE,2CAA2C,4BAA4B,oBAAoB,kCAAkC,kCAAkC,0CAA0C,0CAA0C,sCAAsC,sCAAsC,EAAE,6CAA6C,wCAAwC,0BAA0B,EAAE,sDAAsD,0BAA0B,EAAE,0DAA0D,sBAAsB,uBAAuB,EAAE,2CAA2C,4BAA4B,oBAAoB,qCAAqC,qCAAqC,wCAAwC,wCAAwC,oCAAoC,oCAAoC,EAAE,6CAA6C,qBAAqB,wCAAwC,EAAE,sBAAsB,2DAA2D,EAAE,qCAAqC,wBAAwB,EAAE,+CAA+C,uqF;;;;;;;;;;;;;;;;;;;;;ACAtkD;AACyB;AAKN;AACA;AACA;AAOnE;IASI,kBAAoB,KAAqB,EACrB,MAAc,EACd,WAAwB,EACxB,WAAwB,EACxB,WAAwB;QAJ5C,iBAgBC;QAhBmB,UAAK,GAAL,KAAK,CAAgB;QACrB,WAAM,GAAN,MAAM,CAAQ;QACd,gBAAW,GAAX,WAAW,CAAa;QACxB,gBAAW,GAAX,WAAW,CAAa;QACxB,gBAAW,GAAX,WAAW,CAAa;QAPrC,aAAQ,GAAc,EAAE,CAAC;QAS5B,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC;QAGpD,IAAI,CAAC,KAAK,CAAC,WAAW,CAAC,SAAS,CAAC,gBAAM;YACnC,IAAI,KAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE,CAAC,MAAM,CAAC,KAAK,EAAE;gBACjD,IAAM,MAAM,GAAG,KAAI,CAAC,MAAM,CAAC,oBAAoB,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,MAAM,CAAC;gBACtE,KAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;aACxB;QACL,CAAC,CAAC,CAAC;IAEP,CAAC;IAED,2BAAQ,GAAR;IACA,CAAC;IAEM,0BAAO,GAAd,UAAe,MAAc;QAA7B,iBAOC;QANG,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,SAAS,CAAC,UAAC,IAAU;YAClD,KAAI,CAAC,IAAI,GAAG,IAAI,CAAC;YACjB,KAAI,CAAC,QAAQ,GAAG,KAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YACvD,KAAI,CAAC,OAAO,EAAE,CAAC;YACf,KAAI,CAAC,YAAY,EAAE,CAAC;QACxB,CAAC,CAAC,CAAC;IACP,CAAC;IAEO,0BAAO,GAAf;QAAA,iBAEC;QADG,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,SAAS,CAAC,cAAI,IAAI,YAAI,CAAC,IAAI,GAAG,IAAI,EAAhB,CAAgB,CAAC,CAAC;IACnF,CAAC;IAEM,qCAAkB,GAAzB,UAA0B,MAAM;QAC5B,OAAO,MAAM,CAAC,IAAI,CAAC,MAAM,IAAI,EAAE,CAAC,CAAC,GAAG,CAAC,aAAG,IAAI,aAAM,CAAC,GAAG,CAAC,EAAX,CAAW,CAAC,CAAC;IAC7D,CAAC;IAEM,8BAAW,GAAlB;QAAA,iBAYC;QAVG,IAAM,OAAO,GAAY;YACrB,OAAO,EAAE,IAAI,CAAC,GAAG;YACjB,IAAI,EAAE,IAAI,IAAI,EAAE;YAChB,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,EAAE;YAC7B,YAAY,EAAE,IAAI,CAAC,WAAW,CAAC,IAAI;YACnC,MAAM,EAAE,IAAI,CAAC,WAAW,EAAE;SAC7B,CAAC;QAEF,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,OAAO,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,cAAM,YAAI,CAAC,OAAO,CAAC,KAAI,CAAC,IAAI,CAAC,EAAE,CAAC,EAA1B,CAA0B,CAAC,CAAC;QAC3F,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC;IAClB,CAAC;IAEO,8BAAW,GAAnB;QACI,OAAO,IAAI,CAAC,WAAW,CAAC,EAAE,KAAK,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC;IAC5G,CAAC;IAEM,mCAAgB,GAAvB;QACI,IAAM,gBAAgB,GAAqB;YACvC,KAAK,EAAE;gBACH,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,MAAM;aAC3B;SACJ,CAAC;QACF,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,WAAW,CAAC,EAAE,gBAAgB,CAAC,CAAC;IAC1D,CAAC;IAEM,+BAAY,GAAnB;QAAA,iBAMC;QALG,IAAI,IAAI,CAAC,IAAI,CAAC,aAAa,KAAK,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE;YACjD,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,SAAS,CAAC,cAAI,IAAI,YAAI,CAAC,SAAS,GAAG,IAAI,EAArB,CAAqB,CAAC,CAAC;SAC3F;aAAM;YACH,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,SAAS,CAAC,cAAI,IAAI,YAAI,CAAC,SAAS,GAAG,IAAI,EAArB,CAAqB,CAAC,CAAC;SAC9F;IACL,CAAC;IAEM,kCAAe,GAAtB,UAAuB,MAAc;QACjC,IAAM,gBAAgB,GAAqB;YACvC,KAAK,EAAE;gBACH,MAAM;aACT;SACJ,CAAC;QACF,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,gBAAgB,CAAC,EAAE,gBAAgB,CAAC,CAAC;IAC/D,CAAC;IAEM,6BAAU,GAAjB,UAAkB,OAAO;QACrB,OAAO;YACH,QAAQ,EAAG,OAAO,CAAC,QAAQ,KAAK,IAAI,CAAC,WAAW,CAAC,EAAE;YACnD,QAAQ,EAAE,OAAO,CAAC,QAAQ,KAAK,IAAI,CAAC,WAAW,CAAC,EAAE;SACrD,CAAC;IACN,CAAC;IAEM,wCAAqB,GAA5B;QACI,IAAM,gBAAgB,GAAqB;YACvC,KAAK,EAAE;gBACH,MAAM,EAAE,IAAI,CAAC,SAAS,CAAC,EAAE;aAC5B;SACJ,CAAC;QACF,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,gBAAgB,CAAC,EAAE,gBAAgB,CAAC,CAAC;IAC/D,CAAC;IAzGQ,QAAQ;QALpB,+DAAS,CAAC;YACP,QAAQ,EAAE,UAAU;YACpB,8HAAyC;;SAE5C,CAAC;+EAU6B,8DAAc;YACb,sDAAM;YACD,uEAAW;YACX,uEAAW;YACX,uEAAW;OAbnC,QAAQ,CA6GpB;IAAD,eAAC;CAAA;AA7GoB;;;;;;;;;;;;;;;;;;;;;;;ACfoB;AACM;AACF;AACU;AAEV;AAEI;AAEjD,IAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,6DAAQ;KACpB;CACF,CAAC;AAWF;IAAA;IAA6B,CAAC;IAAjB,cAAc;QAT1B,8DAAQ,CAAC;YACR,OAAO,EAAE;gBACP,4DAAY;gBACZ,0DAAW;gBACX,0DAAW;gBACX,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC;aAC9B;YACD,YAAY,EAAE,CAAC,6DAAQ,CAAC;SACzB,CAAC;OACW,cAAc,CAAG;IAAD,qBAAC;CAAA;AAAH","file":"pages-tabs-messages-chat-chat-module.js","sourcesContent":["import {Injectable} from '@angular/core';\nimport {Ride} from '../../shared/models/Ride';\nimport {AngularFireDatabase} from '@angular/fire/database';\nimport {Observable} from 'rxjs';\nimport {Request} from '../../shared/models/Request';\nimport {User} from '../../shared/models/User';\n\n@Injectable({\n    providedIn: 'root'\n})\nexport class RideService {\n    private collectionEndPoint = 'rides';\n\n    constructor(private db: AngularFireDatabase) {\n    }\n\n    public createRide(ride: Ride): Promise<void> {\n        ride.id = this.db.createPushId();\n        return this.db.object<Ride>(`${this.collectionEndPoint}/${ride.id}`).set(ride);\n    }\n\n    public updateRide(ride: Ride): Promise<void> {\n        return this.db.object<Ride>(`${this.collectionEndPoint}/${ride.id}`).update(ride);\n    }\n\n    public deleteRide(rideId: string): Promise<void> {\n        return this.db.object<Ride>(`${this.collectionEndPoint}/${rideId}`).remove();\n    }\n\n    public getRides(): Observable<Ride[]> {\n        return this.db.list<Ride>(this.collectionEndPoint, ref => ref.orderByChild('dateTime')\n            .startAt(new Date().getTime())).valueChanges();\n    }\n\n    public getRidesByUserId(userId: string): Observable<Ride[]> {\n        return this.db.list<Ride>(this.collectionEndPoint, ref => ref.orderByChild('userId').equalTo(userId)).valueChanges();\n    }\n\n    public getRide(rideId: string): Observable<Ride> {\n        return this.db.object<Ride>(`${this.collectionEndPoint}/${rideId}`).valueChanges();\n    }\n}\n","module.exports = \"<ion-header>\\n  <ion-toolbar>\\n      <ion-title (click)=\\\"goToRidePlanPage()\\\">{{ride?.originName}}\\n           -\\n          {{ride?.destinationName}}</ion-title>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button></ion-back-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content padding>\\n  <div *ngIf=\\\"chat\\\">\\n    <div class=\\\"message-area\\\">\\n      <div class=\\\"message\\\" *ngFor=\\\"let message of messages\\\" [ngClass]=\\\"getClasses(message)\\\">\\n        <ion-avatar *ngIf=\\\"message.fromUser != currentUser.id\\\" (click)=\\\"goToDriverDetailsPage()\\\">\\n          <img src=\\\"{{otherUser?.photo}}\\\"></ion-avatar>\\n        <p>{{message.content}}</p>\\n        <span>{{message.date}}</span>\\n      </div>\\n    </div>\\n  </div>\\n\\n\\n</ion-content>\\n\\n<ion-footer>\\n  <ion-toolbar>\\n    <ion-textarea [(ngModel)]=\\\"msg\\\" class=\\\"message-input\\\" placeholder=\\\"Type a message here\\\" rows=\\\"1\\\" autocapitalize=\\\"off\\\"\\n                  #messageInput\\n                  (keydown.enter)=\\\"sendMessage();false\\\"></ion-textarea>\\n    <ion-buttons slot=\\\"end\\\">\\n      <ion-button color=\\\"primary\\\" (click)=\\\"sendMessage()\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"md-send\\\"></ion-icon>\\n      </ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-footer>\\n\"","module.exports = \":host .message-area {\\n  max-height: 90%;\\n  height: 90%;\\n  overflow: auto;\\n  padding: 15px 10px; }\\n  :host .message-area .message p {\\n    color: #8a898b;\\n    font-size: 13px;\\n    font-weight: bold;\\n    margin: 0px;\\n    max-width: 95%;\\n    min-width: 55%;\\n    box-shadow: 0 1px 1px 0 rgba(0, 0, 0, 0.1);\\n    padding: 10px 15px 10px 7px;\\n    margin: 5px 0;\\n    background: #B9C0E9; }\\n  :host .message-area .message.incoming {\\n    display: -webkit-flex;\\n    display: flex;\\n    -webkit-flex-direction: row;\\n            flex-direction: row;\\n    -webkit-justify-content: flex-start;\\n            justify-content: flex-start;\\n    -webkit-align-items: flex-start;\\n            align-items: flex-start; }\\n  :host .message-area .message.incoming p {\\n      border-radius: 0 11px 11px 11px;\\n      background: white; }\\n  :host .message-area .message.incoming ion-avatar {\\n      margin-right: 5px; }\\n  :host .message-area .message.incoming ion-avatar img {\\n        width: 40px;\\n        height: 40px; }\\n  :host .message-area .message.outgoing {\\n    display: -webkit-flex;\\n    display: flex;\\n    -webkit-flex-direction: column;\\n            flex-direction: column;\\n    -webkit-justify-content: flex-end;\\n            justify-content: flex-end;\\n    -webkit-align-items: flex-end;\\n            align-items: flex-end; }\\n  :host .message-area .message.outgoing p {\\n      color: white;\\n      border-radius: 11px 11px 0 11px; }\\n  :host ion-footer {\\n  --ion-toolbar-background-color: var(--ion-color-white); }\\n  :host ion-footer .message-input {\\n    padding-left: 8px; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tb25leWJhL0RvY3VtZW50cy90Zm0vc3JjL2FwcC9wYWdlcy90YWJzL21lc3NhZ2VzL2NoYXQvY2hhdC1wYWdlLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBR0ksZUFBZTtFQUNmLFdBQVc7RUFDWCxjQUFjO0VBQ2Qsa0JBQWtCLEVBQUE7RUFOdEI7SUFXUSxjQUFjO0lBQ2QsZUFBZTtJQUNmLGlCQUFpQjtJQUNqQixXQUFXO0lBQ1gsY0FBYztJQUNkLGNBQWM7SUFDZCwwQ0FBMEM7SUFDMUMsMkJBQTJCO0lBQzNCLGFBQWE7SUFDYixtQkFBbUIsRUFBQTtFQXBCM0I7SUEwQk0scUJBQWE7SUFBYixhQUFhO0lBQ2IsMkJBQW1CO1lBQW5CLG1CQUFtQjtJQUNuQixtQ0FBMkI7WUFBM0IsMkJBQTJCO0lBQzNCLCtCQUF1QjtZQUF2Qix1QkFBdUIsRUFBQTtFQTdCN0I7TUFnQ1EsK0JBQStCO01BQy9CLGlCQUFpQixFQUFBO0VBakN6QjtNQXFDUSxpQkFBaUIsRUFBQTtFQXJDekI7UUF3Q1UsV0FBVztRQUNYLFlBQVksRUFBQTtFQXpDdEI7SUErQ00scUJBQWE7SUFBYixhQUFhO0lBQ2IsOEJBQXNCO1lBQXRCLHNCQUFzQjtJQUN0QixpQ0FBeUI7WUFBekIseUJBQXlCO0lBQ3pCLDZCQUFxQjtZQUFyQixxQkFBcUIsRUFBQTtFQWxEM0I7TUFxRFEsWUFBWTtNQUNaLCtCQUErQixFQUFBO0VBdER2QztFQTZESSxzREFBK0IsRUFBQTtFQTdEbkM7SUFnRU0saUJBQWlCLEVBQUEiLCJmaWxlIjoic3JjL2FwcC9wYWdlcy90YWJzL21lc3NhZ2VzL2NoYXQvY2hhdC1wYWdlLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiOmhvc3Qge1xuXG4gIC5tZXNzYWdlLWFyZWEge1xuICAgIG1heC1oZWlnaHQ6IDkwJTtcbiAgICBoZWlnaHQ6IDkwJTtcbiAgICBvdmVyZmxvdzogYXV0bztcbiAgICBwYWRkaW5nOiAxNXB4IDEwcHg7XG5cbiAgICAubWVzc2FnZSB7XG5cbiAgICAgIHAge1xuICAgICAgICBjb2xvcjogIzhhODk4YjtcbiAgICAgICAgZm9udC1zaXplOiAxM3B4O1xuICAgICAgICBmb250LXdlaWdodDogYm9sZDtcbiAgICAgICAgbWFyZ2luOiAwcHg7XG4gICAgICAgIG1heC13aWR0aDogOTUlO1xuICAgICAgICBtaW4td2lkdGg6IDU1JTtcbiAgICAgICAgYm94LXNoYWRvdzogMCAxcHggMXB4IDAgcmdiYSgwLCAwLCAwLCAwLjEpO1xuICAgICAgICBwYWRkaW5nOiAxMHB4IDE1cHggMTBweCA3cHg7XG4gICAgICAgIG1hcmdpbjogNXB4IDA7XG4gICAgICAgIGJhY2tncm91bmQ6ICNCOUMwRTk7XG4gICAgICB9XG5cbiAgICB9XG5cbiAgICAubWVzc2FnZS5pbmNvbWluZyB7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICAgIGp1c3RpZnktY29udGVudDogZmxleC1zdGFydDtcbiAgICAgIGFsaWduLWl0ZW1zOiBmbGV4LXN0YXJ0O1xuXG4gICAgICBwIHtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogMCAxMXB4IDExcHggMTFweDtcbiAgICAgICAgYmFja2dyb3VuZDogd2hpdGU7XG4gICAgICB9XG5cbiAgICAgIGlvbi1hdmF0YXIge1xuICAgICAgICBtYXJnaW4tcmlnaHQ6IDVweDtcblxuICAgICAgICBpbWcge1xuICAgICAgICAgIHdpZHRoOiA0MHB4O1xuICAgICAgICAgIGhlaWdodDogNDBweDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC5tZXNzYWdlLm91dGdvaW5nIHtcbiAgICAgIGRpc3BsYXk6IGZsZXg7XG4gICAgICBmbGV4LWRpcmVjdGlvbjogY29sdW1uO1xuICAgICAganVzdGlmeS1jb250ZW50OiBmbGV4LWVuZDtcbiAgICAgIGFsaWduLWl0ZW1zOiBmbGV4LWVuZDtcblxuICAgICAgcCB7XG4gICAgICAgIGNvbG9yOiB3aGl0ZTtcbiAgICAgICAgYm9yZGVyLXJhZGl1czogMTFweCAxMXB4IDAgMTFweDtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuXG4gIGlvbi1mb290ZXIge1xuICAgIC0taW9uLXRvb2xiYXItYmFja2dyb3VuZC1jb2xvcjogdmFyKC0taW9uLWNvbG9yLXdoaXRlKTtcblxuICAgIC5tZXNzYWdlLWlucHV0IHtcbiAgICAgIHBhZGRpbmctbGVmdDogOHB4O1xuICAgIH1cbiAgfVxuXG59XG4iXX0= */\"","import {Component, OnInit} from '@angular/core';\nimport {ActivatedRoute, NavigationExtras, Router} from '@angular/router';\nimport {User} from '../../../../shared/models/User';\nimport {Chat} from '../../../../shared/models/Chat';\nimport {Ride} from '../../../../shared/models/Ride';\nimport {Message} from '../../../../shared/models/Message';\nimport {ChatService} from '../../../../core/services/chat.service';\nimport {UserService} from '../../../../core/services/user.service';\nimport {RideService} from '../../../../core/services/ride.service';\n\n@Component({\n    selector: 'app-chat',\n    templateUrl: './chat-page.component.html',\n    styleUrls: ['./chat-page.component.scss'],\n})\nexport class ChatPage implements OnInit {\n    public chat: Chat;\n    public currentUser: User;\n    public otherUser: User;\n    public ride: Ride;\n\n    public messages: Message[] = [];\n    public msg: string;\n\n    constructor(private route: ActivatedRoute,\n                private router: Router,\n                private chatService: ChatService,\n                private userService: UserService,\n                private rideService: RideService\n    ) {\n        this.currentUser = this.userService.user.getValue();\n\n\n        this.route.queryParams.subscribe(params => {\n            if (this.router.getCurrentNavigation().extras.state) {\n                const chatId = this.router.getCurrentNavigation().extras.state.chatId;\n                this.getChat(chatId);\n            }\n        });\n\n    }\n\n    ngOnInit() {\n    }\n\n    public getChat(chatId: string): void {\n        this.chatService.getChat(chatId).subscribe((chat: Chat) => {\n            this.chat = chat;\n            this.messages = this.getArrayFromObject(chat.messages);\n            this.getRide();\n            this.getOtherUser();\n        });\n    }\n\n    private getRide(): void {\n        this.rideService.getRide(this.chat.rideId).subscribe(ride => this.ride = ride);\n    }\n\n    public getArrayFromObject(object): any[] {\n        return Object.keys(object || {}).map(key => object[key]);\n    }\n\n    public sendMessage(): void {\n\n        const message: Message = {\n            content: this.msg,\n            date: new Date(),\n            fromUser: this.currentUser.id,\n            fromUserName: this.currentUser.name,\n            toUser: this.getReceiver()\n        };\n\n        this.chatService.sendMessage(message, this.chat.id).then(() => this.getChat(this.chat.id));\n        this.msg = '';\n    }\n\n    private getReceiver(): string {\n        return this.currentUser.id === this.chat.passengerUser ? this.chat.driverUser : this.chat.passengerUser;\n    }\n\n    public goToRidePlanPage(): void {\n        const navigationExtras: NavigationExtras = {\n            state: {\n                rideId: this.chat.rideId\n            }\n        };\n        this.router.navigate(['ride-plan'], navigationExtras);\n    }\n\n    public getOtherUser(): void {\n        if (this.chat.passengerUser === this.currentUser.id) {\n            this.userService.getUser(this.chat.driverUser).subscribe(user => this.otherUser = user);\n        } else {\n            this.userService.getUser(this.chat.passengerUser).subscribe(user => this.otherUser = user);\n        }\n    }\n\n    public gotoUserProfile(userId: string): void {\n        const navigationExtras: NavigationExtras = {\n            state: {\n                userId\n            }\n        };\n        this.router.navigate(['public-profile'], navigationExtras);\n    }\n\n    public getClasses(message): any {\n        return {\n            incoming:  message.fromUser !== this.currentUser.id,\n            outgoing: message.fromUser === this.currentUser.id,\n        };\n    }\n\n    public goToDriverDetailsPage(): void {\n        const navigationExtras: NavigationExtras = {\n            state: {\n                userId: this.otherUser.id\n            }\n        };\n        this.router.navigate(['public-profile'], navigationExtras);\n    }\n\n\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ChatPage } from './chat-page.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ChatPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [ChatPage]\n})\nexport class ChatPageModule {}\n"],"sourceRoot":""}