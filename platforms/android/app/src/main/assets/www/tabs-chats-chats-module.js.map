{"version":3,"sources":["webpack:///./src/app/pages/tabs/chats/chats-page.component.html","webpack:///./src/app/pages/tabs/chats/chats-page.component.scss","webpack:///./src/app/pages/tabs/chats/chats-page.component.ts","webpack:///./src/app/pages/tabs/chats/chats.module.ts"],"names":[],"mappings":";;;;;;;;;AAAA,4ZAA4Z,sBAAsB,oBAAoB,uBAAuB,KAAK,4BAA4B,4E;;;;;;;;;;;ACA9f,8BAA8B,uBAAuB,EAAE,+CAA+C,+Y;;;;;;;;;;;;;;;;;;;;;;;;;ACAtD;AACgB;AACA;AAGP;AACV;AACZ;AAC6B;AACM;AACN;AAOhE;IASI,mBAAoB,WAAwB,EACxB,WAAwB,EACxB,MAAc,EACd,WAAwB,EACxB,cAA8B,EAC9B,WAAwB;QALxB,gBAAW,GAAX,WAAW,CAAa;QACxB,gBAAW,GAAX,WAAW,CAAa;QACxB,WAAM,GAAN,MAAM,CAAQ;QACd,gBAAW,GAAX,WAAW,CAAa;QACxB,mBAAc,GAAd,cAAc,CAAgB;QAC9B,gBAAW,GAAX,WAAW,CAAa;QAbrC,mBAAc,GAAG,OAAO,CAAC;QACzB,UAAK,GAAG,EAAE,CAAC;QACX,kBAAa,GAAG,EAAE,CAAC;QAatB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC;IACxD,CAAC;IAED,4BAAQ,GAAR;QACI,IAAI,CAAC,QAAQ,EAAE,CAAC;QAChB,IAAI,CAAC,gBAAgB,EAAE,CAAC;IAC5B,CAAC;IAED,kCAAc,GAAd,UAAe,EAAO;QAClB,IAAI,CAAC,cAAc,GAAG,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC;IAC1C,CAAC;IAEM,4BAAQ,GAAf;QAAA,iBA0BC;QAxBG,IAAM,sBAAsB,GAAG;YAC3B,IAAI,CAAC,WAAW,CAAC,gBAAgB,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE,eAAe,CAAC;YACvE,IAAI,CAAC,WAAW,CAAC,gBAAgB,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,EAAE,YAAY,CAAC;SACvE,CAAC;QAEF,IAAI,CAAC,KAAK,GAAG,0DAAa,CAAC,sBAAsB,CAAC,CAAC,IAAI,CACnD,0DAAG,CAAC,UAAC,EAA6B;gBAA5B,sBAAc,EAAE,mBAAW;YAC7B,OAAO,cAAc,CAAC,MAAM,CAAC,WAAW,CAAC,CAAC;QAC9C,CAAC,CAAC,CACL,CAAC;QAEF,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,eAAK;YACtB,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC;YACnB,KAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YACnB,KAAI,CAAC,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI;gBACpB,IAAI,KAAI,CAAC,WAAW,CAAC,EAAE,KAAK,IAAI,CAAC,UAAU,EAAE;oBACzC,KAAI,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,SAAS,CAAC,uBAAa,IAAI,WAAI,CAAC,SAAS,GAAG,aAAa,EAA9B,CAA8B,CAAC,CAAC;iBAC3G;qBAAM;oBACH,KAAI,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,SAAS,CAAC,oBAAU,IAAI,WAAI,CAAC,SAAS,GAAG,UAAU,EAA3B,CAA2B,CAAC,CAAC;iBAClG;gBAED,KAAI,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,SAAS,CAAC,cAAI,IAAI,WAAI,CAAC,IAAI,GAAG,IAAI,EAAhB,CAAgB,CAAC,CAAC;YAC9E,CAAC,CAAC,CAAC;QACP,CAAC,CAAC,CAAC;IACP,CAAC;IAEM,gCAAY,GAAnB,UAAoB,IAAU;QAC1B,IAAM,gBAAgB,GAAqB;YACvC,KAAK,EAAE;gBACH,MAAM,EAAE,IAAI,CAAC,EAAE;aAClB;SACJ,CAAC;QACF,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,EAAE,gBAAgB,CAAC,CAAC;IACrD,CAAC;IAEM,oCAAgB,GAAvB;QAAA,iBAKC;QAJG,IAAI,CAAC,cAAc,CAAC,uBAAuB,CAAC,IAAI,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,kBAAQ;YAC/E,KAAI,CAAC,aAAa,GAAG,QAAQ,CAAC;QAClC,CAAC,CACD,CAAC;IACL,CAAC;IAEM,wCAAoB,GAA3B,UAA4B,YAAqB;QAC7C,IAAM,gBAAgB,GAAqB;YACvC,KAAK,EAAE;gBACH,YAAY;aACf;SACJ,CAAC;QACF,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,cAAc,CAAC,EAAE,gBAAgB,CAAC,CAAC;IAC7D,CAAC;IA/EQ,SAAS;QALrB,+DAAS,CAAC;YACP,QAAQ,EAAE,WAAW;YACrB,wHAA0C;;SAE7C,CAAC;+EAUmC,uEAAW;YACX,uEAAW;YAChB,sDAAM;YACD,uEAAW;YACR,6EAAc;YACjB,uEAAW;OAdnC,SAAS,CAiFrB;IAAD,gBAAC;CAAA;AAjFqB;;;;;;;;;;;;;;;;;;;;;;;ACjBmB;AACM;AACF;AACU;AAEV;AAEM;AAEnD,IAAM,MAAM,GAAW;IACrB;QACE,IAAI,EAAE,EAAE;QACR,SAAS,EAAE,+DAAS;KACrB;CACF,CAAC;AAWF;IAAA;IAA8B,CAAC;IAAlB,eAAe;QAT3B,8DAAQ,CAAC;YACR,OAAO,EAAE;gBACP,4DAAY;gBACZ,0DAAW;gBACX,0DAAW;gBACX,4DAAY,CAAC,QAAQ,CAAC,MAAM,CAAC;aAC9B;YACD,YAAY,EAAE,CAAC,+DAAS,CAAC;SAC1B,CAAC;OACW,eAAe,CAAG;IAAD,sBAAC;CAAA;AAAH","file":"tabs-chats-chats-module.js","sourcesContent":["module.exports = \"<ion-header>\\n  <ion-toolbar color=\\\"primary\\\">\\n    <ion-title text-center>Chats</ion-title>\\n  </ion-toolbar>\\n\\n\\n</ion-header>\\n\\n<ion-content>\\n  <ion-list *ngFor=\\\"let chat of chats\\\" class=\\\"list-chat\\\">\\n    <ion-item (click)=\\\"goToChatPage(chat)\\\">\\n      <ion-avatar slot=\\\"start\\\">\\n        <img [src]=\\\"chat.otherUser?.photo\\\">\\n      </ion-avatar>\\n      <ion-label>\\n        <p>{{chat.otherUser?.name}}</p>\\n        <h3>{{chat.ride?.originName}} - {{chat.ride?.destinationName}}</h3>\\n      </ion-label>\\n    </ion-item>\\n  </ion-list>\\n</ion-content>\\n\"","module.exports = \".list-chat {\\n  margin-right: 20px; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9tb25leWJhL0Rlc2t0b3AvdW50aXRsZWQgZm9sZGVyL3RmbS9zcmMvYXBwL3BhZ2VzL3RhYnMvY2hhdHMvY2hhdHMtcGFnZS5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLGtCQUFrQixFQUFBIiwiZmlsZSI6InNyYy9hcHAvcGFnZXMvdGFicy9jaGF0cy9jaGF0cy1wYWdlLmNvbXBvbmVudC5zY3NzIiwic291cmNlc0NvbnRlbnQiOlsiLmxpc3QtY2hhdCB7XG4gIG1hcmdpbi1yaWdodDogMjBweDtcbn1cbiJdfQ== */\"","import {Component, OnInit} from '@angular/core';\nimport {AuthService} from '../../../core/services/auth.service';\nimport {ChatService} from '../../../core/services/chat.service';\nimport {User} from '../../../shared/models/User';\nimport {Chat} from '../../../shared/models/Chat';\nimport {NavigationExtras, Router} from '@angular/router';\nimport {combineLatest, Observable} from 'rxjs';\nimport {map} from 'rxjs/operators';\nimport {UserService} from '../../../core/services/user.service';\nimport {RequestService} from '../../../core/services/request.service';\nimport {RideService} from '../../../core/services/ride.service';\n\n@Component({\n    selector: 'app-chats',\n    templateUrl: './chats-page.component.html',\n    styleUrls: ['./chats-page.component.scss'],\n})\nexport class ChatsPage implements OnInit {\n    public currentSegment = 'chats';\n    public chats = [];\n    public notifications = [];\n    private chat$: Observable<any[]>;\n    private currentUser: User;\n    public user: User;\n\n\n    constructor(private authService: AuthService,\n                private chatService: ChatService,\n                private router: Router,\n                private userService: UserService,\n                private requestService: RequestService,\n                private rideService: RideService\n    ) {\n        this.currentUser = this.userService.user.getValue();\n    }\n\n    ngOnInit() {\n        this.getChats();\n        this.getNotifications();\n    }\n\n    segmentChanged(ev: any) {\n        this.currentSegment = ev.detail.value;\n    }\n\n    public getChats() {\n\n        const observablesToSubscribe = [\n            this.chatService.getChatsByUserId(this.currentUser.id, 'passengerUser'),\n            this.chatService.getChatsByUserId(this.currentUser.id, 'driverUser')\n        ];\n\n        this.chat$ = combineLatest(observablesToSubscribe).pipe(\n            map(([passengerChats, driverChats]) => {\n                return passengerChats.concat(driverChats);\n            })\n        );\n\n        this.chat$.subscribe(chats => {\n            console.log(chats);\n            this.chats = chats;\n            this.chats.forEach((chat) => {\n                if (this.currentUser.id === chat.driverUser) {\n                    this.userService.getUser(chat.passengerUser).subscribe(passengerUser => chat.otherUser = passengerUser);\n                } else {\n                    this.userService.getUser(chat.driverUser).subscribe(driverUser => chat.otherUser = driverUser);\n                }\n\n                this.rideService.getRide(chat.rideId).subscribe(ride => chat.ride = ride);\n            });\n        });\n    }\n\n    public goToChatPage(chat: Chat): void {\n        const navigationExtras: NavigationExtras = {\n            state: {\n                chatId: chat.id\n            }\n        };\n        this.router.navigate(['chat'], navigationExtras);\n    }\n\n    public getNotifications(): void {\n        this.requestService.getRequestsByReceiverId(this.currentUser.id).subscribe(requests => {\n            this.notifications = requests;\n        }\n       );\n    }\n\n    public goToChatNotification(notification: Request): void {\n        const navigationExtras: NavigationExtras = {\n            state: {\n                notification\n            }\n        };\n        this.router.navigate(['notification'], navigationExtras);\n    }\n\n}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { ChatsPage } from './chats-page.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: ChatsPage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [ChatsPage]\n})\nexport class ChatsPageModule {}\n"],"sourceRoot":""}